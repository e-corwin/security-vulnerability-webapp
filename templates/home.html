<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="loader" id="myDiv"></div>

    <h3>CVE COMPILATION</h3>
    <h4>CVE COMPILATION maintains a list of Common Vulnerabilities and Exposures (CVEs) and Known Vulnerabilities and Exposures. Then it aids in the sorting of the CVEs by the following filters: date modified, severity score, and product vendor. </h4>
    <form action="/" method="get" class="form-example">
        <label for="severity">Choose Last Modified Time:</label>
        <select name="time" id="time">
            <option value="today" {% if filters[0] == "today" %} selected {% endif %}>Today</option>
            <option value="1week" {% if filters[0] == "1week" %} selected {% endif %}>1 Week</option>
            <option value="1month"{% if filters[0] == "1month" %} selected {% endif %}>1 Month</option>
            <option value="1year"{% if filters[0] == "1year" %} selected {% endif %}>1 Year</option>
        </select>
        <label for="severity">Choose Severity Score:</label>
        <select name="severity" id="severity">
            <option value="all" {% if filters[1] == "all" %} selected {% endif %}>All</option>
            <option value="LOW"{% if filters[1] == "LOW" %} selected {% endif %}>Low</option>
            <option value="MEDIUM" {% if filters[1] == "MEDIUM" %} selected {% endif %}>Medium</option>
            <option value="HIGH"{% if filters[1] == "HIGH" %} selected {% endif %}>High</option>
            <option value="CRITICAL" {% if filters[1] == "CRITICAL" %} selected {% endif %}>Critical</option>
            <option value="severityUnrecognized" {% if filters[1] == "severityUnrecognized" %} selected {% endif %}>Unrecognized Score</option>
        </select>
        <label for="vendor">Choose Vendor:</label>
        <select name="vendor" id="vendor">
            <option value="all" {% if filters[2] == "all" %} selected {% endif %}>All</option>
            {% for vendor in vendors %}
            <option value="{{vendor}}" {% if filters[2] == "vendor" %} selected {% endif %}>{{vendor}}</option>
            {% endfor %}
            <option value="vendorUnrecognized" {% if filters[2] == "Vendor Unknown" %} selected {% endif %}>Vendor Unknown</option>
        </select>
        <div class="form-example">
          <input type="submit" value="Find CVEs" />
        </div>
      </form>
    
   
        {% if filteredCVE['vulnerabilities'] |length == 0 and filteredCISA['vulnerabilities'] |length == 0 %}
        <h4>0 results found</h4>
        {% elif numberEntries |int >= 1000 %}
        <h4>{{"Found" + " " + numberEntries + " " + "results please refine your search"}}</h4>
        {% else %}
        <h4>{{"Showing" + " " + numberEntries + " " + "of" + " " + numberEntries + " " + "results"}}</h4>
        <table class="tg">
        <thead>
          <tr>
            <th class="tg-llyw"><span style="font-weight:bold">CVE ID</span></th>
            <th class="tg-llyw"><span style="font-weight:bold">Description</span></th>
            <th class="tg-llyw"><span style="font-weight:bold">Severity</span></th>
            <th class="tg-llyw"><span style="font-weight:bold">Vendor</span></th>
            <th class="tg-llyw"><span style="font-weight:bold">Source</span></th>
          </tr>
        </thead>
        <tbody>
          {% for i in filteredCVE['vulnerabilities'] %}
          <tr>
            <td class="tg-0pky"><span style="font-weight:400;font-style:normal;"></span><a href="https://nvd.nist.gov/vuln/detail/{{i['cve']['id']}}" style="color: #0079DD;" target="_blank" rel="noopener noreferrer">{{i['cve']['id']}}</a></td>
            <td class="tg-des">{{i['cve']['descriptions'][0]['value']}}</td>
            {% if 'cvssMetricV31' in i['cve']['metrics'] %}
            {% if i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity'] == "LOW" %}
            <td class="tg-0pky"><span style="background-color:#ffc107; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity'] == "MEDIUM" %}
            <td class="tg-0pky"><span style="background-color:#FFA15E; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity'] == "HIGH" %}
            <td class="tg-0pky"><span style="background-color:#F74147; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity'] == "CRITICAL" %}
            <td class="tg-0pky"><span style="background-color:#cb0123; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV31'][0]['cvssData']['baseSeverity']}}</span></td>
            {% endif %}
            {% elif 'cvssMetricV2' in i['cve']['metrics'] %}
            {% if i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity'] == "LOW" %}
            <td class="tg-0pky"><span style="background-color:#ffc107; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity'] == "MEDIUM" %}
            <td class="tg-0pky"><span style="background-color:#FFA15E; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity'] == "HIGH" %}
            <td class="tg-0pky"><span style="background-color:#F74147; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity']}}</span></td>
            {% endif %}
            {% if i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity'] == "CRITICAL" %}
            <td class="tg-0pky"><span style="background-color:#cb0123; padding: 1px 6px">{{i['cve']['metrics']['cvssMetricV2'][0]['baseSeverity']}}</span></td>
            {% endif %}
            {% else %}
            <td class="tg-0pky"><span style="background-color:#415465; padding: 1px 6px">Unrecognized Score</span></td>
            {% endif %}
            <td class="tg-0pky">Unrecognized Vendor</td>
            <td class="tg-0pky"><span style="font-weight:400;font-style:normal;"></span><a href="https://nvd.nist.gov/vuln" style="color:#0079DD;" target="_blank" rel="noopener noreferrer">National Vulnerability Database</a></td>
          </tr>
          {% endfor %}

          {% for i in filteredCISA['vulnerabilities'] %}
          <tr>
            <td class="tg-0pky"><span style="font-weight:400;font-style:normal;"></span><a href="https://nvd.nist.gov/vuln/detail/{{i['cveID']}}" style="color:#0079DD;" target="_blank" rel="noopener noreferrer">{{i['cveID']}}</a></td>
            <td class="tg-des">{{i['shortDescription']}}</td>
            <td class="tg-0pky"><span style="background-color:#415465; padding: 1px 6px">Unrecognized Score</span></td>
            <td class="tg-0pky">{{i['vendorProject']}}</td>
            <td class="tg-0pky"><span style="font-weight:400;font-style:normal;color: white;"></span><a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" style="color:#0079DD;" target="_blank" rel="noopener noreferrer">CISA Known Exploited Vulnerabilities Catalog</a></td>
          </tr>
          {% endfor %}    
    
        </tbody>
        </table>
        {% endif %}

        
</body>
<script>
    var x = document.getElementById("myDiv");
    x.style.display="none";
</script>

</html>