from flask import Flask, render_template, request
import json
import os
import datetime
from datetime import date

app = Flask(__name__)
'''
@app.route('/postjson', methods = ['POST'])
def postJsonHandler():
    print(request.is_json)
    content = request.get_json()
    print(content)
    return 'JSON posted'
  
app.run(host='0.0.0.0', port= 8090)
'''
@app.route("/", methods=['GET', 'POST'])
def home():
    path = '/Users/eliscorwin/all-data.json'
    modify_time = os.path.getmtime(path)
    print(modify_time)
    modify_date = datetime.datetime.fromtimestamp(modify_time)
    print('Modified on:', modify_date)
    print(type(modify_date))

    # now = datetime.now()

    f = open('/Users/eliscorwin/all-data.json')
    DATA = json.load(f)
    print(len(DATA['vulnerabilities']))
    recent_ten = []

    form = request.method
    time = request.args.get("time")
    severity = request.args.get("severity")
    vendor = request.args.get("vendor")
    print(time)
    print(severity)
    print(vendor)
    
    return render_template("home.html")

'''
    with open(all-data.json) as test_file:
        DATA = json.load(test-file)
'''

    # need to return an HTML document
    #render_template('index.html')
'''
@app.route("/search", methods=['GET', 'POST'])
def search():
   
    if request.method == 'POST':
        if request.form.get('action1') == 'VALUE1':
            pass # do something
        elif request.form.get('action2') == 'VALUE2':
            pass # do something else
        else:
            pass # unknown
    elif request.method == 'GET':
        return render_template('home.html', form=form)
    
    return render_template("home.html", form=form)

'''

if __name__ == "__main__":
    app.run()